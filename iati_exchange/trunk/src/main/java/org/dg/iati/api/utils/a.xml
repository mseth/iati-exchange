<?xml version="1.0" encoding="UTF-8"?>
<iati-api-mapping>
   <datasource type="mysql">
   <username>root</username>
   <password></password>
   <url>jdbc:mysql://localhost:3306/amp_ethiopia</url>
   <port></port>
   </datasource>
   <generated-datetime type="current|set">02-21-2011</generated-datetime>
   <iati-activity type="select">select amp_activity_id from amp_activity</iati-activity>
   <global-query type="select | file">select a.name, a.amp_activity_id, a.description, a.objectives, a.activity_start_date, a.activity_close_date, a.actual_start_date, a.actual_approval_date from amp_activity a where a.amp_activity_id = $parent</global-query>
   <mapping>
       <field ref="iati-identifier">
           <content type="column"  prefix="WB-GG-">amp_activity_id</content>
       </field>
       <field ref="title"> 
           <content type="column">name</content>
           <attribute type="constant" ref="xml:lang">en</attribute>
       </field>
       <field ref="description">
           <content type="column">description</content>
           <attribute type="constant" ref="owner-ref" prefix="WB-ER-12-">en</attribute>
           <attribute type="constant" ref="owner-name">en</attribute>
           <field ref=""></field>
       </field>
       <field ref="sector">
		<query type="select">select asec.name as name , asec.sector_code_official as code, ase.sector_percentage as percentage, sch.sec_scheme_code as vocabulary from amp_activity_sector ase, amp_activity act, amp_sector asec, amp_sector_scheme sch where act.amp_activity_id=$parent and act.amp_activity_id=ase.amp_activity_id and asec.amp_sector_id = ase.amp_sector_id and sch.amp_sec_scheme_id = asec.amp_sec_scheme_id
		</query>
		<content type="column">name</content>
		<attribute type="column" ref="code">code</attribute>
		<attribute type="column" ref="percentage">percentage</attribute>
		<attribute type="column" ref="vocabulary">vocabulary</attribute>
		<field ref=""/>
	</field>
       <field ref="transaction">
	   <query type="select">select amp_fund_detail_id, amp_funding_id, transaction_type, donor_name, transaction_amount, transaction_date from v_donor_funding where amp_activity_id=$parent;
	   </query>
	   <content type="column">amp_fund_detail_id</content>
	   <attribute type="column" ref="ref" prefix="WB-ER-12-">amp_funding_id</attribute>
	   <field ref="transaction-type">
		<content type="column">transaction_type</content>
	   </field>
	   <field ref="provider-org">
		<content type="column">donor_name</content>
	   </field>
	   <field ref="value">
		<content type="column">transaction_amount</content>
	   </field>
	   <field ref="transaction-date">
		<content type="column">transaction_date</content>
	   </field>
       </field>
   </mapping>
</iati-api-mapping>